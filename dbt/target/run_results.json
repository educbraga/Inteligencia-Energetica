{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-09-25T04:52:53.249837Z", "invocation_id": "3d8219d7-9570-4cd6-84e8-cc3d14499b6e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-25T04:52:50.240500Z", "completed_at": "2025-09-25T04:52:50.251993Z"}, {"name": "execute", "started_at": "2025-09-25T04:52:50.252988Z", "completed_at": "2025-09-25T04:52:50.624733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3857996463775635, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf47a4-0001-03d4-0000-be41000505b2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.meu_projeto_dbt.stg_usina_disp", "compiled": true, "compiled_code": "-- models/stg_usina_disp.sql\n\n-- Bloco de c\u00f3digo para os dados de Julho\nSELECT\n    '2025-07-01'::DATE AS mes_referencia,\n    id_subsistema::STRING AS id_subsistema,\n    nom_subsistema::STRING AS nom_subsistema,\n    id_estado::STRING AS id_estado,\n    nom_estado::STRING AS nom_estado,\n    id_ons::STRING AS id_ons,\n    ceg::STRING AS ceg,\n    nom_usina::STRING AS nom_usina,\n    id_tipousina::STRING AS id_tipousina,\n    nom_tipocombustivel::STRING AS nom_tipocombustivel,\n    din_instante::TIMESTAMP AS instante,\n    val_potenciainstalada::NUMBER(38, 5) AS pot_instalada_mw,\n    val_dispoperacional::NUMBER(38, 5) AS disp_operacional_mw,\n    val_dispsincronizada::NUMBER(38, 5) AS disp_sincronizada_mw\nFROM IE_DB.staging.disponibilidade_usina_2025_07\n\nUNION ALL\n\n-- Bloco de c\u00f3digo para os dados de Agosto\nSELECT\n    '2025-08-01'::DATE AS mes_referencia,\n    id_subsistema::STRING AS id_subsistema,\n    nom_subsistema::STRING AS nom_subsistema,\n    id_estado::STRING AS id_estado,\n    nom_estado::STRING AS nom_estado,\n    id_ons::STRING AS id_ons,\n    ceg::STRING AS ceg,\n    nom_usina::STRING AS nom_usina,\n    id_tipousina::STRING AS id_tipousina,\n    nom_tipocombustivel::STRING AS nom_tipocombustivel,\n    din_instante::TIMESTAMP AS instante,\n    val_potenciainstalada::NUMBER(38, 5) AS pot_instalada_mw,\n    val_dispoperacional::NUMBER(38, 5) AS disp_operacional_mw,\n    val_dispsincronizada::NUMBER(38, 5) AS disp_sincronizada_mw\nFROM IE_DB.staging.disponibilidade_usina_2025_08\n\nUNION ALL\n\n-- Bloco de c\u00f3digo para os dados de Setembro\nSELECT\n    '2025-09-01'::DATE AS mes_referencia,\n    id_subsistema::STRING AS id_subsistema,\n    nom_subsistema::STRING AS nom_subsistema,\n    id_estado::STRING AS id_estado,\n    nom_estado::STRING AS nom_estado,\n    id_ons::STRING AS id_ons,\n    ceg::STRING AS ceg,\n    nom_usina::STRING AS nom_usina,\n    id_tipousina::STRING AS id_tipousina,\n    nom_tipocombustivel::STRING AS nom_tipocombustivel,\n    din_instante::TIMESTAMP AS instante,\n    val_potenciainstalada::NUMBER(38, 5) AS pot_instalada_mw,\n    val_dispoperacional::NUMBER(38, 5) AS disp_operacional_mw,\n    val_dispsincronizada::NUMBER(38, 5) AS disp_sincronizada_mw\nFROM IE_DB.staging.disponibilidade_usina_2025_09", "relation_name": "IE_DB.STAGING.stg_usina_disp", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-25T04:52:50.667007Z", "completed_at": "2025-09-25T04:52:50.676246Z"}, {"name": "execute", "started_at": "2025-09-25T04:52:50.681095Z", "completed_at": "2025-09-25T04:52:51.094962Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.458010196685791, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf47a4-0001-043d-0000-be410005655a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.meu_projeto_dbt.dim_usina", "compiled": true, "compiled_code": "WITH usinas_unicas AS (\n    SELECT\n        DISTINCT\n        ceg,\n        nom_usina,\n        nom_tipocombustivel\n    FROM IE_DB.STAGING.stg_usina_disp\n)\n\nSELECT\n    md5(cast(coalesce(cast(ceg as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nom_usina as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nom_tipocombustivel as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_dim_usina,\n    ceg,\n    nom_usina,\n    nom_tipocombustivel\nFROM usinas_unicas", "relation_name": "IE_DB.CORE.dim_usina", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-25T04:52:50.639351Z", "completed_at": "2025-09-25T04:52:50.675599Z"}, {"name": "execute", "started_at": "2025-09-25T04:52:50.676764Z", "completed_at": "2025-09-25T04:52:52.148545Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.513883352279663, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf47a4-0001-043d-0000-be410005655e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.meu_projeto_dbt.dim_localidade", "compiled": true, "compiled_code": "WITH localidades_unicas AS (\n    SELECT\n        DISTINCT\n        nom_subsistema,\n        nom_estado\n    FROM IE_DB.STAGING.stg_usina_disp\n)\nSELECT\n    md5(cast(coalesce(cast(nom_subsistema as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(nom_estado as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_dim_localidade,\n    nom_subsistema,\n    nom_estado\nFROM localidades_unicas", "relation_name": "IE_DB.CORE.dim_localidade", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-25T04:52:50.661845Z", "completed_at": "2025-09-25T04:52:50.684923Z"}, {"name": "execute", "started_at": "2025-09-25T04:52:50.686337Z", "completed_at": "2025-09-25T04:52:52.163151Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.527334451675415, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf47a4-0001-03d4-0000-be41000505b6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.meu_projeto_dbt.dim_tempo", "compiled": true, "compiled_code": "WITH instantes_unicos AS (\n    SELECT\n        DISTINCT instante\n    FROM IE_DB.STAGING.stg_usina_disp\n)\nSELECT\n    md5(cast(coalesce(cast(instante::STRING as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_dim_tempo,\n    instante,\n    EXTRACT(YEAR FROM instante)    AS ano,\n    EXTRACT(MONTH FROM instante)   AS mes,\n    EXTRACT(DAY FROM instante)     AS dia,\n    EXTRACT(HOUR FROM instante)    AS hora,\n    EXTRACT(DAYOFWEEK FROM instante) AS dia_da_semana -- Ex: 0=Domingo, 1=Segunda, etc. (varia com o DB)\nFROM instantes_unicos", "relation_name": "IE_DB.CORE.dim_tempo", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-25T04:52:52.170310Z", "completed_at": "2025-09-25T04:52:52.178132Z"}, {"name": "execute", "started_at": "2025-09-25T04:52:52.178780Z", "completed_at": "2025-09-25T04:52:52.597705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42882847785949707, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf47a4-0001-040e-0000-be4100052546"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.meu_projeto_dbt.fact_disponibilidade", "compiled": true, "compiled_code": "-- CTE principal para buscar os dados de staging.\nWITH stg_dados AS (\n    SELECT * FROM IE_DB.STAGING.stg_usina_disp\n),\n\n-- CTE para buscar os dados da dimens\u00e3o de usina.\ndim_usina AS (\n    SELECT * FROM IE_DB.CORE.dim_usina\n),\n\n-- CTE para buscar os dados da dimens\u00e3o de localidade.\ndim_localidade AS (\n    SELECT * FROM IE_DB.CORE.dim_localidade\n),\n\n-- CTE para buscar os dados da dimens\u00e3o de tempo.\ndim_tempo AS (\n    SELECT * FROM IE_DB.CORE.dim_tempo\n)\n\n-- Sele\u00e7\u00e3o final para construir a tabela de fatos.\n-- O objetivo aqui \u00e9 substituir as chaves de neg\u00f3cio (ex: 'ceg', 'nom_estado')\n-- pelas chaves prim\u00e1rias substitutas das tabelas de dimens\u00e3o (ex: 'id_dim_usina').\nSELECT\n    -- Chave prim\u00e1ria da fato (opcional, mas boa pr\u00e1tica)\n    md5(cast(coalesce(cast(stg.ceg as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg.instante as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id_fact_disponibilidade,\n\n    -- Chaves estrangeiras (Foreign Keys) das nossas dimens\u00f5es\n    dus.id_dim_usina,\n    dlo.id_dim_localidade,\n    dti.id_dim_tempo,\n\n    -- Coluna de data original para refer\u00eancia e joins mais f\u00e1ceis\n    stg.instante,\n\n    -- M\u00e9tricas (os fatos num\u00e9ricos que queremos analisar)\n    stg.pot_instalada_mw,\n    stg.disp_operacional_mw,\n    stg.disp_sincronizada_mw\n\nFROM stg_dados AS stg\n\n-- JOIN com a dimens\u00e3o de usina usando a chave de neg\u00f3cio 'ceg'\nLEFT JOIN dim_usina AS dus\n    ON stg.ceg = dus.ceg\n\n-- JOIN com a dimens\u00e3o de localidade usando a combina\u00e7\u00e3o de 'nom_subsistema' e 'nom_estado'\nLEFT JOIN dim_localidade AS dlo\n    ON stg.nom_subsistema = dlo.nom_subsistema\n    AND stg.nom_estado = dlo.nom_estado\n\n-- JOIN com a dimens\u00e3o de tempo usando a chave de neg\u00f3cio 'instante'\nLEFT JOIN dim_tempo AS dti\n    ON stg.instante = dti.instante", "relation_name": "IE_DB.CORE.fact_disponibilidade", "batch_results": null}], "elapsed_time": 7.182499885559082, "args": {"vars": {}, "log_file_max_bytes": 10485760, "favor_state": false, "profiles_dir": "/root/.dbt", "static_parser": true, "write_json": true, "version_check": true, "skip_nodes_if_on_run_start_fails": false, "populate_cache": true, "project_dir": "/usr/app", "macro_debugging": false, "partial_parse_file_diff": true, "introspect": true, "cache_selected_only": false, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": false, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "require_nested_cumulative_type_params": false, "strict_mode": false, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "print": true, "which": "run", "send_anonymous_usage_stats": true, "exclude": [], "defer": false, "use_colors_file": true, "log_format_file": "debug", "show_resource_report": false, "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "log_path": "/usr/app/logs", "quiet": false, "invocation_command": "dbt run", "source_freshness_run_project_hooks": false, "log_level_file": "debug", "state_modified_compare_more_unrendered_values": false, "select": [], "printer_width": 80, "log_level": "info"}}